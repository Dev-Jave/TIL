# Python과 Pandas를 이용한 데이터프레임 처리

## Pandas를 이용해 CSV 파일 읽기
> 판다스(Pandas)는 테이블 데이터를 다루기 위해 사용된 라이브러리로써, CSV, Excel, HTML, JSON, SQL 등과 같은 데이터 파일에 대한 함수들을 지원해준다.

> **CSV** : CSV 파일은 쉼표를 사용하여 값을 구분하는 텍스트 파일이다. 파일의 각 줄은 데이터 레코드이며, 각 레코드는 쉼표로 구분된 하나 이상의 필드로 구성된다.CSV 파일은 일반적으로 테이블 데이터(숫자와 텍스트)를 일반 텍스트로 저장하며, 이 경우 각 행은 동일한 수의 필드를 가진다.

파일을 읽기 위해 Pandas 라이브러리의 `read_csv` 함수를 사용한다.
```python
import pandas as pd

covid_df = pd.read_csv('italy-covid-daywise.csv')
```
파일에서 읽어온 데이터는 **Data Frame** 형태로 저장된다.
* DataFrame : Pandas의 테이블 데이터를 저장하는 핵심 자료구조 중 하나로, 보통 _df 라는 접미를 변수명에 넣어서 데이터프레임인 것을 명시한다.

``` python
type(covid_df) # pandas.core.frame.DataFrame
covid_df # DataFrame 보여주기
```
![pandas_01](/image/pandas_01.png)

데이터 프레임을 통해 다음과 같은 정보를 얻을 수 있다.
- 파일은 이탈리아의 4가지 일별 코로나 데이터를 가지고 있음.
 - 표는 신규 확진자, 사망자, 검사자로 구성되어 있음.
 - 데이터는 248일 분량으로 구성되어 있으며, 2019년 12월부터 2020년 9월까지임.
 
 `info`함수를 사용하여 RangeIndex, dtypes, memory usage등과 같은 추가적인 정보를 얻을 수 있다. 또한, `describe`함수를 활용하면, 수치 데이터로 구성된 열들에 대해서는 요약 통계정보를 확인할 수 있다.
![pandas_02](/image/pandas_02.png)

기본적인 함수를 정리해보자.
- pd.read_csv : CSV 파일로부터 데이터를 읽어와 DataFrame 형태의 객채로 저장함.
- .info() : 행, 열, 데이터 타입과 같은 기본적인 데이터 구조를 확인함.
- .describe() : 수치형 데이터에 대한 요약 통계 정보를 확인함.
- .columns : 열 이름 정보를 리스트로 가지고 있음
- .shape : 행과 열 개수를 튜플 형태로 가지고 있음

## 데이터 프레임의 데이터 다루기
데이터 프레임의 데이터에 쉽게 접근하기 위해서는 데이터 프레임의 내부 구조를 이해하는 것이 좋다. 
개념적으로는 데이터프레임은 리스트를 가지고 있는 하나의 딕셔너리로 구성되어있다고 불 수 있으며, 키 값은 열 이름, 각각의 리스트들은 하나의 행을 의미한다.
``` python
covid_data_dict = {
    'date':['2020-08-30', '2020-08-31', '2020-09-01', '2020-09-02', '2020-09-03'],
    'new_cases': [1444, 1365, 996, 975, 1326],
    'new_deaths': [1, 4, 6, 8, 6],
    'new_tests': [53541, 42583, 54395, None, None]
}
```
리스트로 구성된 딕셔너리와 같이 특정 열에 행으 ㅣ인덱스 값을 넣어 데이터프레임에서 데이터에 접근할 수 있다.
``` python
covid_data_dict['new_cases']
covid_df['new_case']
``` 
각 열들은 `Series`라고 불리는 데이터 구조로 표현된다. `Series`는 몇가지 추가적인 형태를 가지고 있는 Numpy 배열과 같다.
Series는 배열과 같이 []와 인덱싱을 통해 특정 행과 특정 열에 명시적으로 접근할 수 있다. 

또한 Pandas는 at이라는 함수를 통해 특정 행과 열에 명시적으로 접근할 수 있다.
``` python
covid_df['new_cases'][240]
covid_df.at[246, 'new_cases']
```
bracket 표기법을 사용하는 것 대신에, 판다스는 열 접근할 때 . 표기법을 사용할 있다. 그러나 이 방법은 열의 이름에 공백이 있거나 틀수문자가 있다면 불가능하다.
``` python
covid_df.new_cases
```
또한 bracket을 이용하여 데이터 프레임의 특정 열들로 구성된 하부 데이터셋을 구성할 수도 있다.
``` python
case_df = covid_df[['date', 'new_cases']]
```
새로운 데이터 프레임인 cases_df는 단순히 원본 데이터를 보여주는 역할을 한다. **두 변수에서 데이터는 하나의 메모리에 할당되기 때문에 한 변수에서 데이터에 변화를 주게 되면 다른 쪽에도 영향을 주게된다.** 이러한 방식은 Pandas를 사용해 대량의 데이터를 처리할 때 속도를 높이고 메모리 사용을 줄여준다.

그러나, 가끔 독립적인 하부 데이터셋이 필요한 경우가 있는데, 이런 경우 `.copy` 메소드를 통해 깊은 복사를 수행할 수 있다.
``` python
covid_df_copy = covid_df.copy()
```
covid_df_copy안에 있는 데이터들은 covid_df로 부터 완전히 분리된 데이터이며 값의 변화는 서로 영향을 주지 않는다.
### Pandas를 통해 값 조정하기
| 절대 좌표(위치) 지정 | x | o | x  | o  |
| --- | --- | --- | --- | --- |
| 라벨명 지정 | o | x | o | x |
| 여러개의 요소 지정 | o | o | x | x |
| 슬라이스 표기 | o | o | x | x |

**1) 좌표(위치)의 지정 방법**

- at, loc : 행 명(행 라벨), 열 명(열 라벨)
- iat, iloc : 행 번호, 열 번호(절대 좌표(위치)지정)

**2) 선택하여 확인, 변경할 수 있는 데이터**

- at, iat : 하나의 요소 값
- loc, iloc : 하나 혹은 여러 개의 요소 값
- 리스트, 슬라이스로 범위를 지정할 수 있다.
- 행, 열을 선택하여 값을 획득하고 변경할 수 있다.

**3) 그 외의 차이점**

- 처리 속도는 at 과 iat의 경우가 loc과 iloc보다 빠르다
- 라벨과 번호를 합쳐서 위치를 지정하고 싶은 경우는 at 혹은 loc과 index나 column을 조합합니다.

- at, iat : 하나의 요소 값을 선택, 획득, 변경
- loc, iloc : 하나 혹은 여러 개의 요소 값을 선택, 획득, 변경
- 하나의 요소 값을 선택
- 여러 개의 요소 값을 선택
- 행, 열을 선택
- 행 명, 열 명이 중복된 값을 가진 경우
- 번호와 라벨 단위를 지정
- 행을 pandas.Series로 선택할 때 묵시적형 변환



## 데이터 프레임의 데이터 분석하기

## 쿼리와 데이터 정렬

## 시간의 활용

## 다양한 데이터들을 합치기

## 데이터를 다시 파일로 저장하기
